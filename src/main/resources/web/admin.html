<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/xhtml">
<head th:replace="fragments :: header (role='Admin')">
<body class="cms admin">


<th:block th:include="fragments :: top-bar"/>

<div class="content">
    <div class="content-header">
        <div class="content-header-label">Dashboard</div>
    </div>
    <div id="dashboard">
        <div id="data-rectangles" class="data-rectangles">
            <div class="rectangle">
                <div class="rectangle-bar">
                    Hello administrator
                </div>
                <div id="full-name" class="rectangle-content">
                    John Smith
                </div>
            </div>
        </div>
    </div>
    <div id="user-management" class="hidden">
        <div class="row">
            <form method="get" action="/users/add">
                <h3 class="heading">New user</h3>
                <div class="row">
                    <label class="input-label" for="type">Type</label>
                    <select class="input-select" name ="type" id="type">
                        <option value="student">Student</option>
                        <option value="mentor">Mentor</option>
                        <option value="administrator">Administrator</option>
                    </select>
                </div>
                <div class="row">
                    <label class="input-label" for="nickname">Nickname</label>
                    <input class="input-field" type="text" name = "nickname" id="nickname" required/>
                </div>
                <div class="row">
                    <label class="input-label" for="email">Email</label>
                    <input class="input-field" type="text" name = "email" id="email" required/>
                </div>
                <input type="submit" class="button submit-button" value="Create">
            </form>
        </div>
        <div class="row">
            <h3 class="heading">Users</h3>
            <table style="width:100%">
                <tr>
                    <th>Name</th>
                    <th>Last name</th>
                    <th>Email</th>
                    <th>Type</th>
                    <th></th>
                </tr>
                <tr>
                    <td>Jacek</td>
                    <td>Placek</td>
                    <td>japa@email.com</td>
                    <td>Student</td>
                    <td class="edit-icons">
                        <a class="ion-edit edit-icon" title="Edit user" href="http://localhost:8000/users/add"></a>
                        <a class="ion-clipboard edit-icon" title="Show user"></a>
                        <a class="ion-trash-a edit-icon" title="Remove user"></a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="class-management" class="hidden">

        <div class="row">
            <h3 class="heading">New class</h3>
            <form action="/class/add">
                <div class="row">
                    <label class="input-label" for="class-name">Class name</label>
                    <input class="input-field" name = "name" type="text" id="class-name" required/>
                </div>
                <input type="submit" class="button submit-button" value="Create">
            </form>
        </div>
        <div class="row">
            <h3 class="heading">Classes</h3>
            <table style="width:100%">
                <tr>
                    <th>Name</th>
                    <th>Action</th>
                </tr>
                <tr th:each="class : ${classes}">
                    <td>HTML Programers</td>
                    <td class="edit-icons">
                        <ul class="nav">
                            <li class="nav-tab"><i class="ion-trash-a edit-icon" title="Delete class"></i></li>
                            <li class="nav-tab"><i class="ion-edit edit-icon" title="Edit class"></i></li>
                            <li class="nav-tab"><i class="ion-android-people edit-icon"></i></li>
                        </ul>
                    </td>

                </tr>
            </table>

        </div>
    </div>

    <div id="level-management" class="hidden">
        <div class="row">
            <h3 class="heading">Level creation</h3>
            <table style="width:100%">
                <tr>
                    <th>Name</th>
                    <th>Threshold</th>
                </tr>
                <tr>
                    <td class="level-table"><input id="level-name" type="text" placeholder="Enter level name."></td>
                    <td class="level-table"><input id="threshold" type="number" placeholder="Enter level threshold."></td>
                </tr>
            </table>
            <input class="button submit-button" type="submit" value="Create">
        </div>
        <table style="width:100%">
        <tr>
            <th>Name</th>
            <th>Threshold</th>
            <th>Action</th>
        </tr>
        <tr>
            <td class="level-table">Scratch Developer</td>
            <td class="level-table">999999</td>
            <td class="edit-icons">
                <ul class="nav">
                    <li class="nav-tab"><i class="ion-trash-a edit-icon" title = "Delete level"></i></li>
                    <li class="nav-tab"><i class="ion-edit edit-icon" title = "Edit level"></i></li>
                </ul>
            </td>
        </tr>
        </table>
    </div>
</div>

<div class="left-bar">
    <div class="logo">
        <span class="icon rotate"></span> <span style="color: #5ca4cb">Quest</span><span style="color:#d9484b;">Store</span>
    </div>
    <ul class="options">
        <li class="option selected" id="switch-dashboard">
            <i class="ion-ios-home-outline option-icon"></i>
            <p class="option-text">Dashboard</p>
        </li>
        <li class="option" id="switch-user-management">
            <i class="ion-ios-person-outline option-icon"></i>
            <p class="option-text">User management</p>
        </li>
        <li class="option" id="switch-class-management">
            <i class="ion-ios-people-outline option-icon"></i>
            <p class="option-text">Class management</p>
        </li>
        <li class="option" id="switch-level-management">
            <i class="ion-ios-bookmarks-outline option-icon"></i>
            <p class="option-text">Level management</p>
        </li>
    </ul>
</div>
<script src="static/resources/js/app.js"></script>
<script>
    let modal = document.getElementById('myModal');
    let modal_content = document.querySelector('.modal-content');
    let edit_user_form = document.getElementById('edit-user-form');
    let edit_artifact_form = document.getElementById('edit-artifact-form');

    let edit_user_buttons = Array.from(document.getElementsByClassName('edit-user-button'));
    let edit_artifact_buttons = Array.from(document.getElementsByClassName('edit-artifact-button'));
    let edit_quest_buttons = Array.from(document.getElementsByClassName('edit-quest-button'));

    edit_user_buttons.forEach(element => {

        element.onclick = function(event) {
            modal_content.innerHTML = edit_user_form.innerHTML;
            modal.style.display = "block";

            let inputElements = Array.from(modal_content.getElementsByTagName('*'));


            let edit_user_data = Array.from(event.target.parentNode.parentNode.getElementsByTagName('TD'));

            let editHeader = inputElements.filter(t => t.tagName === "H3")[0];
            editHeader.innerText = `Edit user - ${edit_user_data[0].innerText}`;

            inputElements = inputElements.filter(t => t.tagName === "INPUT");
            inputElements[0].setAttribute('value', edit_user_data[0].innerText);
            inputElements[1].setAttribute('value', edit_user_data[0].innerText);
            inputElements[2].setAttribute('value', edit_user_data[1].innerText);
        }
    });

    edit_artifact_buttons.forEach(element => {

        element.onclick = function(event) {
            modal_content.innerHTML = edit_artifact_form.innerHTML;
            modal.style.display = "block";

            let inputElements = Array.from(modal_content.getElementsByTagName('*'));

//            inputElements.forEach(t => console.log(t));

            let edit_artifact_data = Array.from(event.target.parentNode.parentNode.parentNode.parentNode.getElementsByTagName('td'));

            edit_artifact_data.forEach(t => console.log(t));
            let editHeader = inputElements.filter(t => t.tagName === "H3")[0];
            editHeader.innerText = `Edit artifact - ${edit_artifact_data[0].innerText}`;

            inputElements = inputElements.filter(t => t.tagName === "INPUT");
            inputElements.forEach(t => console.log(t));
            inputElements[0].setAttribute('value', edit_artifact_data[0].innerText);
            inputElements[1].setAttribute('value', edit_artifact_data[0].innerText);
            inputElements[2].setAttribute('value', edit_artifact_data[2].innerText);
            inputElements[3].setAttribute('value', edit_artifact_data[3].innerText);
        }
    });

    edit_quest_buttons.forEach(element => {

        element.onclick = function(event) {
            modal_content.innerHTML = edit_artifact_form.innerHTML;
            modal.style.display = "block";

            let inputElements = Array.from(modal_content.getElementsByTagName('*'));

//            inputElements.forEach(t => console.log(t));

            let edit_artifact_data = Array.from(event.target.parentNode.parentNode.parentNode.parentNode.getElementsByTagName('td'));

            edit_artifact_data.forEach(t => console.log(t));
            let editHeader = inputElements.filter(t => t.tagName === "H3")[0];
            editHeader.innerText = `Edit quest - ${edit_artifact_data[0].innerText}`;

            inputElements = inputElements.filter(t => t.tagName === "INPUT");
            inputElements.forEach(t => console.log(t));
            inputElements[0].setAttribute('value', edit_artifact_data[0].innerText);
            inputElements[1].setAttribute('value', edit_artifact_data[0].innerText);
            inputElements[2].setAttribute('value', edit_artifact_data[2].innerText);
            inputElements[3].setAttribute('value', edit_artifact_data[3].innerText);
        }
    });


    let span = document.getElementsByClassName("close")[0];


    span.onclick = function () {
        modal.style.display = "none";
    };

    window.onclick = function(event) {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    }
</script>
</body>
</html>
